webpackJsonp([31],{OU7F:function(t,e){},We70:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("PE0f"),a=i("fjIZ"),s=i("rHWf"),o=i("Pfph"),r={data:function(){return{dialog:!1,list:null,searchList:null,magazine:"",typeList:null,type:null,position:null,keyword:"",stateList:[{position:"0",name:"草稿箱"},{position:"2",name:"上线资讯"},{position:"4",name:"回收站"}],user:"",role:"",setNumId:"",viewNum:0}},created:function(){this._initData(),this.user=JSON.parse(Object(o.a)()),this.role=this.user.roleId},methods:{outdata:function(){Object(s.e)("《顾家人》2018年5月上半刊（总第135期）")},_searchState:function(t){var e=this;Object(n.d)(this.magazine.name,this.type,t).then(function(t){e.list=t.data})},_setCarousel:function(t){var e=this;Object(n.j)(t,1).then(function(t){e.$message({message:t.message,type:"success",duration:3e3}),e._initData()})},_cancelCarousel:function(t){var e=this;Object(n.j)(t,0).then(function(t){e.$message({message:t.message,type:"success",duration:3e3}),e._initData()})},del:function(t){var e=this;this.$confirm("即将删除期刊, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.a)(t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e._initData()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},searchMagazine:function(t){var e=this;Object(n.b)(t.name).then(function(i){if(e.list=i.data,3==JSON.parse(Object(o.a)()).roleId){var a=[];for(var s in e.list)0==e.list[s].position&&a.push(e.list[s]);e.list=a}e.position=null,Object(n.e)(t.name).then(function(t){e.typeList=t.data,e.type=""})})},_searchDocument:function(t){var e=this;Object(n.i)(this.magazine.name,t).then(function(t){if(e.list=t.data,3==JSON.parse(Object(o.a)()).roleId){var i=[];for(var n in e.list)0==e.list[n].position&&i.push(e.list[n]);e.list=i}})},_initData:function(){var t=this;Object(s.c)(1).then(function(e){t.magazine=e.data.itemList[0],t.searchList=e.data.itemList,Object(n.e)(e.data.itemList[0].name).then(function(e){t.typeList=e.data,t.type=""}),e.data.itemList.length&&Object(n.b)(e.data.itemList[0].name).then(function(e){if(t.list=e.data,3==JSON.parse(Object(o.a)()).roleId){var i=[];for(var n in t.list)0==t.list[n].position&&i.push(t.list[n]);t.list=i}})})},editor:function(t){this.$router.push({name:"addNews",query:{id:t}})},goComment:function(t){this.$router.push({name:"commentList",query:{id:t}})},pushDoc:function(t){var e=this;this.$confirm("即将推送, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i="《"+t+"》";Object(n.k)(i,1).then(function(t){if(0==t.data.errorlist.length)e.$alert("已推送至全部部门!","提示",{confirmButtonText:"确定",type:"warning"});else{var i="";for(var n in t.data.errorlist){i+=t.data.errorlist[n]+"，"}i+="以上部门未推送成功",e.$alert(i,"提示",{confirmButtonText:"确定",type:"warning"})}})}).catch(function(){e.$message({type:"info",message:"取消推送"})})},addDoc:function(t){var e=this;Object(s.d)(t).then(function(t){e._initData(),e.$message({message:t.message,type:"success",duration:3e3})})},search:function(t){var e=this;Object(s.f)(t).then(function(t){e.searchList=t.data.itemList})},searchDocByword:function(){var t=this;Object(n.h)(this.keyword).then(function(e){t.list=e.data})},openViewNum:function(t){this.dialog=!0,this.setNumId=t},saveNum:function(){var t=this;Object(s.a)(this.setNumId,this.viewNum).then(function(e){t.dialog=!1,t._initData(),t.$message({message:e.message,type:"success",duration:3e3}),t.setNumId="",t.viewNum=0})}},filters:{formatDate:function(t){var e=new Date(t);return Object(a.a)(e,"yyyy-MM-dd")},stage:function(t){return 0==t?"草稿箱":1==t?"审批中":2==t?"上线":3==t?"下线":4==t?"回收站":void 0}},computed:{outUrl:function(){return"/kukacms/visitor/exportExcel.htm?magazine="+this.magazine.name}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",{staticStyle:{margin:"10px 0","font-size":"24px"}},[t._v("资讯列表")]),t._v(" "),i("el-row",{staticStyle:{margin:"15px","min-width":"1000px"},attrs:{type:"flex"}},[i("el-col",{staticStyle:{width:"270px"}},[i("span",[t._v("期刊号：")]),t._v(" "),i("el-select",{attrs:{"value-key":"name",filterable:"","filter-method":t.search,placeholder:"请选择期刊号",size:"mini"},on:{change:t.searchMagazine},model:{value:t.magazine,callback:function(e){t.magazine=e},expression:"magazine"}},t._l(t.searchList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})}),1)],1),t._v(" "),i("el-col",{staticStyle:{width:"320px"}},[i("span",[t._v("栏目：")]),t._v(" "),i("el-select",{attrs:{filterable:"",placeholder:"请选择栏目",size:"mini"},on:{change:t._searchDocument},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),3!=t.role?i("el-col",{staticStyle:{width:"220px"}},[i("span",[t._v("状态：")]),t._v(" "),i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"请选择状态",size:"mini"},on:{change:t._searchState},model:{value:t.position,callback:function(e){t.position=e},expression:"position"}},t._l(t.stateList,function(t){return i("el-option",{key:t.position,attrs:{label:t.name,value:t.position}})}),1)],1):t._e()],1),t._v(" "),i("div",{staticStyle:{padding:"10px",display:"flex"}},[i("span",{staticStyle:{"line-height":"28px",margin:"0 5px"}},[t._v("搜索文章：")]),t._v(" "),i("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{size:"mini"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.searchDocByword}},[t._v("搜索")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"}},[i("a",{attrs:{href:t.outUrl,download:""}},[t._v("导出")])])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[i("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"magazine",label:"期刊号"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"typeName",label:"栏目",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"name",label:"标题"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("p",[t._v(t._s(t._f("stage")(e.row.position)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[3!=t.role?i("p",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.pushDoc(e.row.name)}}},[t._v("单篇通知")]),t._v(" "),[0==e.row.clientApp?i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.addDoc(e.row.id)}}},[t._v("单篇上线")]):i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.addDoc(e.row.id)}}},[t._v("重新上线")])],t._v(" "),1==e.row.isCarousel?i("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(i){return t._cancelCarousel(e.row.id)}}},[t._v("取消轮播图")]):i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t._setCarousel(e.row.id)}}},[t._v("设置成轮播图")])],2):t._e(),t._v(" "),i("p",[3!=t.role?[i("el-badge",{staticStyle:{"margin-right":"15px"},attrs:{value:e.row.commentNum}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.goComment(e.row.id)}}},[t._v("评论管理")])],1),t._v(" "),i("el-badge",{staticStyle:{"margin-right":"15px"},attrs:{value:e.row.pageViewNum}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.openViewNum(e.row.id)}}},[t._v("浏览管理")])],1)]:t._e(),t._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.editor(e.row.id)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.del(e.row.id)}}},[t._v("删除")])],2)]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:"浏览量设置",visible:t.dialog,"append-to-body":!0,width:"600px"},on:{"update:visible":function(e){t.dialog=e}}},[i("el-input",{model:{value:t.viewNum,callback:function(e){t.viewNum=e},expression:"viewNum"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.saveNum}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var c=i("C7Lr")(r,l,!1,function(t){i("OU7F")},"data-v-3bfef602",null);e.default=c.exports}});
//# sourceMappingURL=31.9f19a51143729ed09f3f.js.map